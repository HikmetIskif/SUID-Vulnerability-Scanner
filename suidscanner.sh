#!/bin/bash

find / -type f -user root -perm -4000 -exec ls -ldb {} \; 2>>/dev/null > tempfile.txt

countsuid=$(wc tempfile.txt | cut -d ' ' -f 3)

countexploit=$(wc vulnerabilities.txt | cut -d ' ' -f 2)

for (( sayi=1; sayi<=$countsuid; sayi++ ))
do
    name=$(sed -n "${sayi}p"  deneme.txt)
    lastname="${name##*/}"
    
    for ((dongu=1; dongu<=$countexploit; dongu++))
    do
    	exploit=$(sed -n "${dongu}p"  vulnerabilities.txt)
    	if [ $exploit = $lastname ]
    	then
    		echo " $lastname is exploitable !"
    		break
    	fi
    	
    done
    
done

rm tempfile.txt
